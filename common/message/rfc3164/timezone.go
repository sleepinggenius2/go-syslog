package rfc3164

import (
	"sync"
	"time"
)

var timezoneAbbrs = map[string]int{
	"A":    3600 * 1,
	"ACDT": 3600*10 + 60*30,
	"ACST": 3600*9 + 60*30,
	"ACWT": 3600*8 + 60*45,
	"ADT":  -3600 * 3,
	//"ADT": 3600*3,
	"ACT":  -3600 * 5,
	"AEDT": 3600 * 11,
	"AEST": 3600 * 10,
	"AFT":  3600*4 + 60*30,
	"AKDT": -3600 * 8,
	"AKST": -3600 * 9,
	"ALMT": 3600 * 6,
	"AMT":  3600 * 4,
	//"AMT": -3600*4,
	"AMST": -3600 * 3,
	//"AMST": 3600*5,
	"ANAT":  3600 * 12,
	"ANAST": 3600 * 12,
	"AQTT":  3600 * 5,
	"ART":   -3600 * 3,
	"AST":   -3600 * 4,
	//"AST": 3600*3,
	"AWDT":  3600 * 9,
	"AWST":  3600 * 8,
	"AZOT":  -3600 * 1,
	"AZOST": 0,
	"AZT":   3600 * 4,
	"AZST":  3600 * 5,
	"B":     3600 * 2,
	"BNT":   3600 * 8,
	"BDT":   3600 * 6,
	"BOT":   -3600 * 4,
	"BRT":   -3600 * 3,
	"BRST":  -3600 * 2,
	"BST":   3600 * 1,
	//"BST": 3600*6,
	"BTT":  3600 * 6,
	"C":    3600 * 3,
	"CAST": 3600 * 8,
	"CAT":  3600 * 2,
	"CCT":  3600*6 + 60*30,
	//"CDT": 3600*10+60*30,
	"CDT":   -3600 * 5,
	"CEDT":  3600 * 2,
	"CEST":  3600 * 2,
	"CET":   3600 * 1,
	"CHADT": 3600*13 + 60*45,
	"CHAST": 3600*12 + 60*45,
	"CHOT":  3600 * 8,
	"CHOST": 3600 * 9,
	"CHsT":  3600 * 10,
	"CHUT":  3600 * 10,
	"CIT":   3600 * 8,
	"CKT":   -3600 * 10,
	"CLST":  -3600 * 3,
	"CLT":   -3600 * 4,
	"COT":   -3600 * 5,
	//"CST": 3600*9+60*30,
	"CST": -3600 * 6,
	//"CST": -3600*5,
	//"CST": 3600*8,
	"CVT":   -3600 * 1,
	"CWST":  3600*8 + 60*45,
	"CXT":   3600 * 7,
	"D":     3600 * 4,
	"DAVT":  3600 * 7,
	"DDUT":  3600 * 10,
	"E":     3600 * 5,
	"EASST": -3600 * 5,
	"EAST":  -3600 * 6,
	"EAT":   3600 * 3,
	"ECT":   -3600 * 5,
	//"EDT": 3600*11,
	"EDT":  -3600 * 4,
	"EEDT": 3600 * 3,
	"EEST": 3600 * 3,
	"EET":  3600 * 2,
	"EGT":  -3600 * 1,
	"EGST": 0,
	//"EST": 3600*10,
	"EST":  -3600 * 5,
	"EIT":  3600 * 9,
	"F":    3600 * 6,
	"FET":  3600 * 3,
	"FJT":  3600 * 12,
	"FJST": 3600 * 13,
	"FKST": -3600 * 3,
	"FKT":  -3600 * 4,
	"FNT":  -3600 * 2,
	"G":    3600 * 7,
	"GALT": -3600 * 6,
	"GAMT": -3600 * 9,
	"GET":  3600 * 4,
	"GFT":  -3600 * 3,
	"GILT": 3600 * 12,
	"GMT":  0,
	"GST":  3600 * 4,
	//"GST": -3600*2,
	"GYT":   -3600 * 4,
	"H":     3600 * 8,
	"HADT":  -3600 * 9,
	"HAST":  -3600 * 10,
	"HKT":   3600 * 8,
	"HOVT":  3600 * 7,
	"HOVST": 3600 * 8,
	"HST":   -3600 * 10,
	"I":     3600 * 9,
	"ICT":   3600 * 7,
	"IDT":   3600 * 3,
	"IOT":   3600 * 6,
	"IRDT":  3600*4 + 60*30,
	"IRKT":  3600 * 8,
	"IRKST": 3600 * 9,
	"IRST":  3600*3 + 60*30,
	//"IST": 3600*5+60*30,
	"IST": 3600 * 2,
	//"IST": 3600*1,
	"JST":   3600 * 9,
	"K":     3600 * 10,
	"KGT":   3600 * 6,
	"KOST":  3600 * 11,
	"KRAT":  3600 * 7,
	"KRAST": 3600 * 8,
	"KST":   3600 * 9,
	"KUYT":  3600 * 4,
	"L":     3600 * 11,
	"LHDT":  3600 * 11,
	"LHST":  3600*10 + 60*30,
	"LINT":  3600 * 14,
	"M":     3600 * 12,
	"MAGT":  3600 * 11,
	"MAGST": 3600 * 12,
	"MART":  -3600*9 + 60*30,
	"MAWT":  3600 * 5,
	"MDT":   -3600 * 6,
	"MeST":  -3600 * 8,
	"MHT":   3600 * 12,
	"MIST":  3600 * 11,
	"MMT":   3600*6 + 60*30,
	"MSD":   3600 * 4,
	"MSK":   3600 * 3,
	"MST":   -3600 * 7,
	"MUT":   3600 * 4,
	"MVT":   3600 * 5,
	"MYT":   3600 * 8,
	"N":     -3600 * 1,
	"NCT":   3600 * 11,
	"NDT":   -3600*2 + 60*30,
	"NFT":   3600 * 11,
	"NOVT":  3600 * 6,
	"NOVST": 3600 * 7,
	"NPT":   3600*5 + 60*45,
	"NRT":   3600 * 12,
	"NST":   -3600*3 + 60*30,
	"NT":    -3600*3 + 60*30,
	"NUT":   -3600 * 11,
	"NZDT":  3600 * 13,
	"NZST":  3600 * 12,
	"O":     -3600 * 2,
	"OMST":  3600 * 6,
	"OMSST": 3600 * 7,
	"ORAT":  3600 * 5,
	"P":     -3600 * 3,
	"PDT":   -3600 * 7,
	"PET":   -3600 * 5,
	"PETT":  3600 * 12,
	"PETST": 3600 * 12,
	"PGT":   3600 * 10,
	"PHT":   3600 * 8,
	"PHOT":  3600 * 13,
	"PKT":   3600 * 5,
	"PMDT":  -3600 * 2,
	"PMST":  -3600 * 3,
	"PONT":  3600 * 11,
	"PST":   -3600 * 8,
	//"PST": 3600*8+60*30,
	"PWT":   3600 * 9,
	"PYT":   -3600 * 4,
	"PYST":  -3600 * 3,
	"Q":     -3600 * 4,
	"QYZT":  3600 * 6,
	"R":     -3600 * 5,
	"RET":   3600 * 4,
	"ROTT":  -3600 * 3,
	"S":     -3600 * 6,
	"SAKT":  3600 * 11,
	"SAMT":  3600 * 4,
	"SAST":  3600 * 2,
	"SBT":   3600 * 11,
	"SCT":   3600 * 4,
	"SGT":   3600 * 8,
	"SRT":   -3600 * 3,
	"SLT":   3600*5 + 60*30,
	"SLST":  3600*5 + 60*30,
	"SRET":  3600 * 11,
	"SST":   -3600 * 11,
	"SYOT":  3600 * 3,
	"T":     -3600 * 7,
	"TAHT":  -3600 * 10,
	"TFT":   3600 * 5,
	"TJT":   3600 * 5,
	"TKT":   3600 * 13,
	"TLT":   3600 * 9,
	"TMT":   3600 * 5,
	"TOT":   3600 * 13,
	"TRT":   3600 * 3,
	"TRUT":  3600 * 10,
	"TVT":   3600 * 12,
	"U":     -3600 * 8,
	"ULAT":  3600 * 8,
	"ULAST": 3600 * 9,
	"UTC":   0,
	"UYST":  -3600 * 2,
	"UYT":   -3600 * 3,
	"UZT":   3600 * 5,
	"V":     -3600 * 9,
	"VET":   -3600 * 4,
	"VLAT":  3600 * 10,
	"VLAST": 3600 * 11,
	"VOLT":  3600 * 4,
	"VUT":   3600 * 11,
	"W":     -3600 * 10,
	"WAKT":  3600 * 12,
	"WAT":   3600 * 1,
	"WAST":  3600 * 2,
	"WDT":   3600 * 9,
	"WEDT":  3600 * 1,
	"WEST":  3600 * 1,
	"WET":   0,
	"WFT":   3600 * 12,
	"WGT":   -3600 * 3,
	"WGST":  -3600 * 2,
	"WIB":   3600 * 7,
	"WIT":   3600 * 9,
	"WITA":  3600 * 8,
	"WST":   3600 * 1,
	//"WST": 3600*8,
	//"WST": 3600*13,
	//"WST": 3600*14,
	"WT":    0,
	"X":     -3600 * 11,
	"Y":     -3600 * 12,
	"YAKT":  3600 * 9,
	"YAKST": 3600 * 10,
	"YAP":   3600 * 10,
	"YEKT":  3600 * 5,
	"YEKST": 3600 * 6,
}

var timezoneCache sync.Map

func getTimezone(name string) *time.Location {
	offset := timezoneAbbrs[name]
	if offset == 0 {
		return time.UTC
	}
	tz, ok := timezoneCache.Load(name)
	if !ok {
		tz = time.FixedZone(name, offset)
		timezoneCache.Store(name, tz)
	}
	return tz.(*time.Location)
}

func SetOffset(name string, offset int) {
	timezoneAbbrs[name] = offset
}
